---
// src/components/AddToCartButton.astro
interface Props {
  serviceId: number;
  serviceName: string;
  class?: string;
}

const { serviceId, serviceName, class: className = "" } = Astro.props;
---

<button
  relative px-4 py-2 
  bg="yellow-400 hover:yellow-500"
  text="neutral-900"
  font="semibold"
  border="rounded-lg"
  transition="all duration-200"
  active="scale-95"
  focus="ring-2 ring-yellow-300"
  class={`group ${className}`}
  
  onclick={`window.addToCart(${serviceId}, '${serviceName}')`}
  aria-label={`Add ${serviceName} to cart`}
>
  <div flex="~ items-center gap-2">
    <span>Add to Cart</span>
    
    <!-- Tagify: Menggunakan ikon sebagai tag kustom -->
    <i-lucide-shopping-cart 
      text="lg" 
      transition="transform"
      class="group-hover:scale-110"
    />
  </div>
</button>

<script>
  import { cartManager } from '../services/cartService';

  declare global {
    interface Window {
      addToCart: (serviceId: number, serviceName: string) => void;
    }
  }

  window.addToCart = (serviceId, serviceName) => {
    cartManager.addToCart(
      { id: serviceId, name: serviceName, price: 0, rate: 0, rateCount: 0, description: '', img: '' } as any,
      1,
      1
    );
    
    // Show toast notification
    const toast = document.createElement('div');
    toast.className = 'fixed bottom-24 right-4 bg-green-500 text-white px-4 py-3 rounded-lg shadow-lg animate-slide-up z-50';
    toast.textContent = `${serviceName} ditambahkan ke keranjang`;
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.classList.add('animate-fade-out');
      setTimeout(() => toast.remove(), 300);
    }, 2000);
  };
</script>