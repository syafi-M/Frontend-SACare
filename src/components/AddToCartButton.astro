---
// src/components/AddToCartButton.astro
interface Props {
  serviceId: number;
  serviceName: string;
  class?: string;
}

const { serviceId, serviceName, class: className = "" } = Astro.props;
---

<button
  class={`group relative px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-neutral-900 font-semibold rounded-lg transition-all duration-200 active:scale-95 focus:ring-2 focus:ring-yellow-300 ${className}`}
  onclick={`window.addToCart(${serviceId}, '${serviceName}')`}
  aria-label={`Add ${serviceName} to cart`}
>
  <div class="flex items-center gap-2">
    <span>Add to Cart</span>
    <div class="i-tabler-shopping-bag text-lg group-hover:scale-110 transition-transform" />
  </div>
</button>

<script>
  import { cartManager } from '../services/cartService';

  declare global {
    interface Window {
      addToCart: (serviceId: number, serviceName: string) => void;
    }
  }

  window.addToCart = (serviceId, serviceName) => {
    cartManager.addToCart(
      { id: serviceId, name: serviceName, price: 0, rate: 0, rateCount: 0, description: '', img: '' } as any,
      1,
      1
    );
    
    // Show toast notification
    const toast = document.createElement('div');
    toast.className = 'fixed bottom-24 right-4 bg-green-500 text-white px-4 py-3 rounded-lg shadow-lg animate-slide-up z-50';
    toast.textContent = `${serviceName} ditambahkan ke keranjang`;
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.classList.add('animate-fade-out');
      setTimeout(() => toast.remove(), 300);
    }, 2000);
  };
</script>

<style>
  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }

  :global(.animate-slide-up) {
    animation: slideUp 0.3s ease-out;
  }

  :global(.animate-fade-out) {
    animation: fadeOut 0.3s ease-out forwards;
  }
</style>