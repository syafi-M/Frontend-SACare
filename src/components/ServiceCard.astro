---
// src/components/ServiceCard.astro
import type { Service } from '../types/service';
import { formatCurrency } from '../utils/format';

interface Props {
  service: Service;
  isPopular?: boolean;
}

const { service, isPopular = false } = Astro.props;
---

<article
  border="~ neutral-200" rounded-2xl bg-white shadow-sm transition="all duration-300"
  class="group hover:shadow-lg overflow-hidden h-full flex flex-col"
  data-service-id={service.id}
>
  <!-- Image Section -->
  <div relative overflow-hidden bg-neutral-100 h-64>
    <img
      src={service.img}
      alt={service.name}
      loading="lazy"
      decoding="async"
      w-full h-full object-cover transition="transform duration-500 ease-out"
      class="rounded-t-xl group-hover:scale-110"
    />

    <!-- Label Terpopuler (Phosphor Crown) -->
    {isPopular && (
      <div 
        absolute top-4 left-4 p="x-3 y-1" 
        bg="yellow-500/90" backdrop="blur-md" rounded-full shadow-md
        class="animate-slide-in"
      >
        <span text="[10px] neutral-900" font-black flex="~ items-center gap-1" uppercase italic>
          <div class="i-ph-crown-simple-fill text-sm"></div>
          Most Booked
        </span>
      </div>
    )}

    <!-- Rating Badge (Phosphor Star) -->
    <div 
      absolute top-4 right-4 p="x-3 y-1"
      flex="~ items-center gap-1.5" bg="white/90" backdrop="blur-md" rounded-full shadow-sm 
      class="animate-slide-in"
    >
      <div class="i-ph-star-fill text-[14px] text-yellow-500"></div>
      <span text="xs neutral-900" font-bold>{service.rate}</span>
      <span text="neutral-500 [10px]">({service.rateCount})</span>
    </div>
  </div>

  <!-- Content Section -->
  <div p-6 flex="~ col flex-1">
    <div flex-grow mb-6>
      <h3 
        text="lg neutral-900" font-bold mb-2 transition="colors duration-200"
        class="group-hover:text-yellow-600"
      >
        {service.name}
      </h3>
      <p text="neutral-500 sm" leading-relaxed class="line-clamp-2">
        {service.description}
      </p>
    </div>

    <!-- Price & Button Footer -->
    <div 
      flex="~ justify-between items-center" pt-4 border="t neutral-100" 
      transition="colors duration-200"
      class="group-hover:border-neutral-200"
    >
      <div>
        <p text="[9px] neutral-400" font-bold uppercase tracking-widest leading-none mb-1>Price starts</p>
        <p text="xl neutral-900" font-black leading-none>
          {formatCurrency(service.price)}<span text="[10px] text-neutral-400 font-normal">/jam</span>
        </p>
      </div>
      
      <button
        px-4 py-2 rounded-xl font-bold text-xs transition="all duration-200"
        bg="neutral-900 hover:neutral-800" text-white
        active="scale-95"
        flex="~ items-center gap-2"
        onclick={`event.stopPropagation(); window.openServiceModal(${service.id})`}
      >
        <span>Details</span>
        <div class="i-ph-arrow-right-bold text-[10px]"></div>
      </button>
    </div>
  </div>
</article>