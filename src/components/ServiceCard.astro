---
// src/components/ServiceCard.astro
import type { Service } from '../types/service';
import { formatCurrency } from '../utils/format';

interface Props {
  service: Service;
  isPopular?: boolean;
}

const { service, isPopular = false } = Astro.props;
---

<article
  class="service-card border border-neutral-200 rounded-2xl bg-white shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group"
  data-service-id={service.id}
>
  <div class="relative overflow-hidden bg-neutral-100">
    <img
      src={service.img}
      alt={service.name}
      loading="lazy"
      decoding="async"
      class="w-full h-64 object-cover rounded-t-xl transition-transform duration-500 ease-out group-hover:scale-110"
    />

    {isPopular && (
      <div class="absolute top-4 left-4 bg-yellow-500/90 backdrop-blur-md rounded-full px-3 py-1 shadow-md animate-slide-in" style="animation-delay: 200ms">
        <span class="text-xs font-semibold text-neutral-800 flex items-center gap-1">
          <i class="i-tabler-crown text-base"></i>
          Most Booked
        </span>
      </div>
    )}

    <div class="absolute top-4 right-4 flex items-center gap-1 bg-white/90 backdrop-blur-md rounded-full px-3 py-1 shadow-md animate-slide-in" style="animation-delay: 100ms">
      <i class="i-tabler-star-filled text-xs text-yellow-500"></i>
      <span class="text-xs font-semibold text-neutral-800">{service.rate}</span>
      <span class="text-neutral-700/70 text-[10px]">({service.rateCount})</span>
    </div>
  </div>

  <div class="p-6 flex flex-col h-full">
    <div class="flex-grow mb-4">
      <h3 class="text-lg font-semibold text-neutral-800 mb-2 group-hover:text-neutral-900 transition-colors duration-200">
        {service.name}
      </h3>
      <p class="text-neutral-600 text-sm line-clamp-2 group-hover:text-neutral-700 transition-colors duration-200">
        {service.description}
      </p>
    </div>

    <div class="flex justify-between items-center pt-4 border-t border-neutral-100 group-hover:border-neutral-200 transition-colors duration-200">
      <p class="text-xl font-bold text-neutral-800 group-hover:text-neutral-900 transition-colors duration-200">
        {formatCurrency(service.price)}
        <span class="text-xs text-neutral-500 font-normal"> / jam</span>
      </p>
      <button
        class="px-4 py-2 bg-neutral-800 text-white rounded-lg hover:bg-neutral-900 transition-all duration-200 font-medium text-sm active:scale-95 focus:ring-2 focus:ring-neutral-800 focus:ring-offset-2"
        aria-label={`Book ${service.name}`}
      >
        Book Now
      </button>
    </div>
  </div>
</article>

<style>
  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(-8px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  :global(.animate-slide-in) {
    animation: slideInRight 0.3s ease-out forwards;
    opacity: 0;
  }

  :global(.line-clamp-2) {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>